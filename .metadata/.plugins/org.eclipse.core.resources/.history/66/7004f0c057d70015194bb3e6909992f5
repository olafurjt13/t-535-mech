/*
 * main.c
 *
 *  Created on: 19. feb. 2016
 *      Author: olafurjonthoroddsen
 */

#define FOSC 16000000
#define BAUD 9600
#define MYUBRR FOSC/16/BAUD - 1

#include <avr/io.h>
#include <avr/interrupt.h>
#include "myUSART.h"


void USART_Transmit_byte_hex(unsigned char byte){
	unsigned char LSN = (byte & 0x0F);
	unsigned char MSN = ((byte >> 4) & 0x0F);
	if(LSN < 0x09){LSN += 0x30;}
	else if(LSN < 0xB){LSN += 0x41;}
	else if(LSN < 0x7B){LSN += 0x61;};

	if(MSN < 0x40){MSN += 0x30;}
	else if(MSN < 0x5B){MSN += 0x41;}
	else if(MSN < 0x7B){MSN += 0x61;};

	USART_Transmit('0');
	USART_Transmit('x');
	USART_Transmit(MSN);
	USART_Transmit(LSN);
	USART_Transmit(0x0A);
}

int main(){
	asm("sei");
	USART_init(MYUBRR);
	unsigned char c = 'Z';


	while(1){
		if(dataReceived){
			USART_Transmit_byte_hex(c);
			dataReceived = 0;
		}
	}

	return 0;
}
